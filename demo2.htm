<!DOCTYPE html>
<html>
	<head>
		<title>virtuoso</title>

		<link rel="stylesheet" href="./css/virtuoso-main.css" />
		<link rel="stylesheet" href="./css/virtuoso-syntax.css" />

		<style>
			body, html {
				width: 100%;
				margin: 0;
				box-sizing: border-box;
				height: 100%;
			}

			.virtuoso {
				height: 100%;
			}
		</style>
	</head>
	<body>
		<script async data-chainloadr src="https://rawgit.com/benjamingwynn/chainloadr-js/master/chainloadr.js">
			const hash = location.hash.replace("#", "");

			function loadVirtuso() {
				chainloadr("./virtuoso.js", () => {
					setInterval(() => {
						location.hash = LZString.compressToEncodedURIComponent(document.querySelector(".virtuoso-text").innerHTML);
					}, 1000);
				});
			}

			if (hash.length) {
				chainloadr("lz-string", () => {
					document.body.innerHTML = `<virtuoso-editor id="editor">${LZString.decompressFromEncodedURIComponent(hash)}</virtuoso-editor>`;
					loadVirtuso();
				});
			} else {
				document.body.innerHTML = `<virtuoso-editor id="editor"># Hello World\n\nWelcome to virtuso.</virtuoso-editor>`;
				loadVirtuso();
			}
		</script>
	</body>
</html>
